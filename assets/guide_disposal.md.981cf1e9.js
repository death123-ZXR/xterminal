import{_ as s,o as a,c as e,X as n}from"./chunks/framework.37cee08b.js";const h=JSON.parse('{"title":"Disposal","description":"","frontmatter":{},"headers":[],"relativePath":"guide/disposal.md","filePath":"guide/disposal.md"}'),o={name:"guide/disposal.md"},l=n(`<h1 id="disposal" tabindex="-1">Disposal <a class="header-anchor" href="#disposal" aria-label="Permalink to &quot;Disposal&quot;">​</a></h1><p>Nearly everything that makes up the terminal is disposable. Right from the base class to the events that are dispatched, all these can be disposed.</p><h2 id="why-dispose" tabindex="-1">Why dispose? <a class="header-anchor" href="#why-dispose" aria-label="Permalink to &quot;Why dispose?&quot;">​</a></h2><p>The <code>XTerminal</code> package is lightweight and on top of that, its efficiency during runtime is greatly considered.</p><p>A disposable object refers to an object that can self detach itself from a parent via a <a href="./../api/#term-dispose">term.dispose()</a> method.</p><p>With reference to the DOM, remember how <code>document.addEventListener</code> and <code>document.removeEventListener</code> work: one adds an event callback function and the other destroys it from the same event.</p><p>It is nearly the same here.</p><p>The significance of the <code>dispose</code> method on an object is not only to manage memory but also ensure that certain functionality only runs at specific times it is needed.</p><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h2><p>Suppose you have multiple instances of objects with each maintaining it&#39;s own state. When the use of the instance is done, we can then dispose its state thereby gracefully saving memory.</p><p>We can implement it like this:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> states </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">WeakMap</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">State</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createState</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">app</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">states</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">State</span><span style="color:#F07178;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">disposed</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">get</span><span style="color:#F07178;"> state</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">states</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">app</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        dispose</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">disposed</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">disposed</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">states</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">app</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>Whenever a new state is created using <code>createState</code> from the above example, a <em>disposable state object</em> is returned. This implies that when the <code>dispose</code> method on that object is invoked, the entire state for that app is deleted.</p><h2 id="terminal-disposal" tabindex="-1">Terminal Disposal <a class="header-anchor" href="#terminal-disposal" aria-label="Permalink to &quot;Terminal Disposal&quot;">​</a></h2><p>It is possible that you might want to close off the terminal and end it&#39;s usage. In this case, you can entirely dispose the terminal using <a href="./../api/#term-dispose">term.dispose()</a>. This will clear states of the underlying objects, dispose events, remove the HTML elements and their DOM events.</p><p>This tears down the entire terminal and renders it not usable thereafter.</p><p><strong>Example:</strong> On window unload event (free up resources)</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onunload</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> term</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispose</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span></code></pre></div>`,18),p=[l];function t(c,r,i,y,F,d){return a(),e("div",null,p)}const A=s(o,[["render",t]]);export{h as __pageData,A as default};
